Below is an updated version of your README that reflects the current modifications to the deployment process, which now uses Docker Hub and GitHub Actions for automatic updates instead of manual AWS EC2 deployment.

---

```markdown
# FastAPI Book Management API

## Overview

This project is a RESTful API built with FastAPI for managing a book collection. It provides comprehensive CRUD (Create, Read, Update, Delete) operations for books with proper error handling, input validation, and documentation.

## Features

- ðŸ“š Book management (CRUD operations)
- âœ… Input validation using Pydantic models
- ðŸ” Enum-based genre classification
- ðŸ§ª Complete test coverage
- ðŸ“ API documentation (auto-generated by FastAPI)
- ðŸ”’ CORS middleware enabled

## Project Structure
```

fastapi-book-project/
â”œâ”€â”€ api/
â”‚ â”œâ”€â”€ db/
â”‚ â”‚ â”œâ”€â”€ **init**.py
â”‚ â”‚ â””â”€â”€ schemas.py # Data models and in-memory database
â”‚ â”œâ”€â”€ routes/
â”‚ â”‚ â”œâ”€â”€ **init**.py
â”‚ â”‚ â””â”€â”€ books.py # Book route handlers
â”‚ â””â”€â”€ router.py # API router configuration
â”œâ”€â”€ core/
â”‚ â”œâ”€â”€ **init**.py
â”‚ â””â”€â”€ config.py # Application settings
â”œâ”€â”€ tests/
â”‚ â”œâ”€â”€ **init**.py
â”‚ â””â”€â”€ test_books.py # API endpoint tests
â”œâ”€â”€ main.py # Application entry point
â”œâ”€â”€ Dockerfile # Docker build instructions
â”œâ”€â”€ docker-compose.yml # Docker Compose configuration
â”œâ”€â”€ requirements.txt # Project dependencies
â””â”€â”€ README.md

````

## Technologies Used

- Python 3.12
- FastAPI
- Pydantic
- pytest
- uvicorn
- Docker
- GitHub Actions
- Nginx

## Installation

1. **Clone the repository:**

   ```bash
   git clone https://github.com/yourusername/fastapi-book-project.git
   cd fastapi-book-project
````

2. **Create a virtual environment:**

   ```bash
   python3 -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

3. **Install dependencies:**

   ```bash
   pip install -r requirements.txt
   ```

## Running the Application Locally

1. **Start the server:**

   ```bash
   uvicorn main:app --host 0.0.0.0 --port 8000
   ```

2. **Access the API documentation:**

   - Swagger UI: [http://localhost:8000/docs](http://localhost:8000/docs)
   - ReDoc: [http://localhost:8000/redoc](http://localhost:8000/redoc)

## Deployment Instructions

This project now uses GitHub Actions to build, push, and deploy your Docker image automatically. Every push to the main branch triggers the workflow, ensuring that any changes (for example, new endpoints or modifications) are automatically reflected on your hosted application.

### 1. GitHub Actions & Docker Hub Setup

- **GitHub Secrets:**  
  In your repository settings, add the following secrets:
  - `DOCKER_USERNAME`: Your Docker Hub username.
  - `DOCKER_PASSWORD`: Your Docker Hub password.
  - `EC2_SERVER_HOST`: The IPv4 address of the AWS EC2 instance.
  - `EC2_SERVER_USERNAME`: The username of the AWS EC2 instance (ubuntu).
  - `SERVER_SSH_KEY`: The SSH private key for your AWS EC2 instance server.

### 2. Workflow

The provided `.github/workflows/deploy.yml` file performs these steps:

- Checks out the repository.
- Logs in to Docker Hub.
- Builds a Docker image from your Dockerfile and pushes it to Docker Hub.
- Connects to the remote server via SSH.
- Clones (or updates) the repository on the remote host.
- Pulls the latest Docker image from Docker Hub.
- Restarts the running containers using Docker Compose.

Here is the sample workflow file:

```yaml
name: cd pipeline

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Log in to Docker Hub
        run: echo "${{ secrets.DOCKER_PASSWORD }}" | docker login -u "${{ secrets.DOCKER_USERNAME }}" --password-stdin

      - name: Build and push Docker image
        run: |
          docker build -t ${{ secrets.DOCKER_USERNAME }}/fastapi-app:latest .
          docker push ${{ secrets.DOCKER_USERNAME }}/fastapi-app:latest

      - name: Deploy on remote server
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SERVER_SSH_KEY }}
          script: |
            cd /home/ubuntu/
            if [ ! -d "hngx-stage2-fastapi-project" ]; then
              git clone https://github.com/yourusername/fastapi-book-project.git
            fi
            cd hngx-stage2-fastapi-project
            git pull origin main
            docker pull ${{ secrets.DOCKER_USERNAME }}/fastapi-app:latest
            docker-compose down || true
            docker-compose up -d
```

### 3. Updated Docker Compose

The `docker-compose.yml` file is now configured to use the pre-built Docker image from Docker Hub instead of building the image locally:

```yaml
version: "3.8"
services:
  app:
    image: your_docker_username/fastapi-app:latest
    container_name: fastapi-app
    ports:
      - "8000:8000"

  nginx:
    image: nginx:latest
    container_name: fastapi-nginx
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    ports:
      - "80:80"
    depends_on:
      - app
```

> Replace `your_docker_username` with your actual Docker Hub username.

### 4. Automatic Deployment

Each push to the main branch will:

- Trigger the GitHub Actions workflow.
- Build and push a new Docker image to Docker Hub.
- Update your remote server by pulling the latest repository changes and Docker image, then restarting the containers.

This ensures that any modifications (such as adding new endpoints) are automatically deployed to your host.

## Running Tests

Run the test suite using:

```bash
pytest
```

## Contributing

1. Fork the repository.
2. Create a feature branch (`git checkout -b feature/AmazingFeature`).
3. Commit your changes (`git commit -m 'Add AmazingFeature'`).
4. Push to the branch (`git push origin feature/AmazingFeature`).
5. Open a Pull Request.

## License

This project is licensed under the MIT License â€“ see the [LICENSE](LICENSE) file for details.

## Support

For support, please open an issue in the GitHub repository.
